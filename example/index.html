<html>
<head>
	<script type="text/javascript" src="puredom.light.js"></script>
	<script type="text/javascript" src="../puredom.momentouch.js"></script>
	<link rel="stylesheet" href="style.css" type="text/css">
</head>
<body>
	<div id="container">
		<div class="ball" id="foo"></div>
		<div class="ball" id="bar"></div>
		<div class="ball" id="baz"></div>
	</div>
</body>
<script type="text/javascript">
puredom(function() {
	var bounds = {
		x: puredom('#container').width(),
		y: puredom('#container').height()
	};
	
	puredom(window).on('resize', function(e) {
		bounds.x = puredom('#container').width();
		bounds.y = puredom('#container').height();
	});
	
	puredom('.ball')
		.momentouch({dragFactor: 0.999})
		.on('slidestart', function(e) { puredom(this).classify('sliding'); })
		.on('sliding', function(e) {
			var ball = puredom(this),
				w = ball.width(),
				h = ball.height();
			
			ball.css({'-webkit-transform': 'rotate(' + (e.angle + 45) + 'deg)'});
			
			var x = ball.x() + e.deltaX,
				y = ball.y() + e.deltaY;
			
			if (x > bounds.x + w/2) {
				x = -w;
			} else if (x < -w) {
				x = bounds.x;
			}
			
			if (y > bounds.y + h/2) {
				y = -h;
			} else if (y < -h) {
				y = bounds.y;
			}
			
			ball.position(Math.round(x), Math.round(y));
		})
		.on('slidestop', function(e) { puredom(this).declassify('sliding'); });
});

puredom('.ball').each(function(elem) {
	console.log('adding keyclick to ' + elem.attr('id'));
	elem.keyclick({leftClick: 65});
});
</script>
</html>
